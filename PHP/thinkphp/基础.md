# 基础

##目录结构

tp5
├─application 应用目录
├─extend 扩展类库目录（ 可定义）
├─public 网站对外访问目录
├─runtime 运行时目录（ 可定义）
├─vendor 第三方类库目录（ Composer）
├─thinkphp 框架核心目录
├─build.php 自动生成定义文件（ 参考）
├─composer.json Composer定义文件
├─LICENSE.txt 授权说明文件
├─README.md README 文件
├─think 命令行工具入口

| a               | a            | a           |
| --------------- | ------------ | ----------- |
| tp5             | 项目根目录        | ROOT_PATH   |
| tp5/application | 应用目录         | APP_PATH    |
| tp5/thinkphp    | 框架核心目录       | THINK_PATH  |
| tp5/exend       | 应用扩展目录       | EXTEND_PATH |
| tp5/vendor      | Composer扩展目录 | VENDOR_PATH |

核心框架目录的结构如下：
├─thinkphp 框架系统目录
│ ├─lang 语言包目录
│ ├─library 框架核心类库目录
│ │ ├─think think 类库包目录
│ │ └─traits 系统 traits 目录
│ ├─tpl 系统模板目录
│ │
│ ├─.htaccess 用于 apache 的重写
│ ├─.travis.yml CI 定义文件
│ ├─base.php 框架基础文件
│ ├─composer.json composer 定义文件
│ ├─console.php 控制台入口文件
│ ├─convention.php 惯例配置文件
│ ├─helper.php 助手函数文件（ 可选）
│ ├─LICENSE.txt 授权说明文件
│ ├─phpunit.xml 单元测试配置文件
│ ├─README.md README 文件
│ └─start.php 框架引导文件

ThinkPHP5.0 版本的默认自带的入口文件位于 public/index.php （实际部署的时候 public 目录为
你的应用对外访问目录），入口文件内容如下：

```php
// 定义应用目录
define('APP_PATH', __DIR__ . '/../application/');
// 加载框架引导文件
require __DIR__ . '/../thinkphp/start.php';
```

这段代码的作用就是定义应用目录 APP_PATH 和加载 ThinkPHP 框架的入口文件，这是所有基于
ThinkPHP 开发应用的第一步。
我们可以在浏览器中访问入口文件
http://localhost/tp5/public/

###添加新的模块

如果我要添加新的模块可以使用控制台命令来生成。切换到命令行模式下，进入到应用根目录并执行如下指令：
`php think build --module demo`

官方提供的默认应用的实际目录结构和说明如下：
├─application 应用目录（ 可设置）
│ ├─index 模块目录(可更改)
│ │ ├─config.php 模块配置文件
│ │ ├─common.php 模块公共文件
│ │ ├─controller 控制器目录
│ │ ├─model 模型目录
│ │ └─view 视图目录
│ │
│ ├─command.php 命令行工具配置文件
│ ├─common.php 应用公共文件
│ ├─config.php 应用配置文件
│ ├─tags.php 应用行为扩展定义文件
│ ├─database.php 数据库配置文件
│ └─route.php 路由配置文件

##控制器

我们找到 index 模块的 Index 控制器（文件位于 application/index/controller/Index.php 注
意大小写），我们把 Index 控制器类的 index 方法修改为 Hello,World！ 。

```
<?php
namespace app\index\controller;
class Index
{
public function index()
{
return 'Hello,World！';
}
}


class Index
{
public function index($name = 'World')
{
return 'Hello,' . $name . '！';
}
}
```
#### protected与private

```
class Index
{
    public function hello()
    {
        return 'hello,thinkphp!';
    }public function test()
    {
        return '这是一个测试方法!';
    }protected function hello2()
    {
        return '只是protected方法!';
    }private function hello3()
    {
        return '这是private方法!';
    }
}
```

`http://127.0.0.1/tp5/public/index.php/index/index/hello`

当我们访问 hello2 和 hello3 操作方法后的结果都会显示类似的异常信息

##视图

我们在 application/index 目录下面创建一个 view 目录，然后添加模板文件 view/index/hello.html ，我们添加模板内容如下：

```
<html>
<head>
    <title>hello {$name}</title>
</head>
<body>
    hello, {$name}!
</body>
</html>
```

```
class Index extends Controller
{
    public function hello($name = 'thinkphp')
    {
        $this->assign('name', $name);
        return $this->fetch();
    }
}
```

 ## 关于权限

`runtime`文件夹需要777权限，`chmod -R 777 runtime`

## 读取数据

首先我们需要在应用的数据库配置文件 application/database.php 中添加数据库的连接信息如下：

```
return [
    // 数据库类型
    'type'            => 'mysql',
    // 服务器地址
    'hostname'        => '127.0.0.1',
    // 数据库名
    'database'        => '',
    // 用户名
    'username'        => 'root',
    // 密码
    'password'        => '',
    // 端口
    'hostport'        => '',
    // 连接dsn
    'dsn'             => '',
    // 数据库连接参数
    'params'          => [],
    // 数据库编码默认采用utf8
    'charset'         => 'utf8',
    // 数据库表前缀
    'prefix'          => '',
    // 数据库调试模式
    'debug'           => true,
    // 数据库部署方式:0 集中式(单一服务器),1 分布式(主从服务器)
    'deploy'          => 0,
    // 数据库读写是否分离 主从式有效
    'rw_separate'     => false,
    // 读写分离后 主服务器数量
    'master_num'      => 1,
    // 指定从服务器序号
    'slave_no'        => '',
    // 是否严格检查字段是否存在
    'fields_strict'   => true,
    // 数据集返回类型
    'resultset_type'  => 'array',
    // 自动写入时间戳字段
    'auto_timestamp'  => false,
    // 时间字段取出后的默认时间格式
    'datetime_format' => 'Y-m-d H:i:s',
    // 是否需要进行SQL性能分析
    'sql_explain'     => false,
];
```

```

```

#URL和路由

`http://serverName/index.php/模块/控制器/操作`

* 如果我们直接访问入口文件的话，由于URL中没有模块、 控制器和操作，因此系统会访问默认模块（index）下面的默认控制器（Index）的默认操作（index），因此下面的访问是等效的：
  * `http://tp5.com/index.php`
  * `http://tp5.com/index.php/index/index/index`


* 果要访问控制器的hello方法，则需要使用完整的URL地址
  * `http://tp5.com/index.php/index/index/hello`
* 如果你的控制器是驼峰的，例如定义一个HelloWorld控制器（application/index/controller/HelloWorld.php ）
  * 正确的URL访问地址（该地址可以使用url方法生成）应该是：
    `http://tp5.com/index.php/index/hello_world/index`
* 如果希望严格区分大小写访问（或者要支持驼峰法进行控制器访问），可以在应用配置文件中设置：`'url_convert' => false,`

如果你的服务器环境不支持 pathinfo 方式的URL访问，可以使用兼容方式，例如：
`http://tp5.com/index.php?s=/index/Index/index`

### Nginx配置

找到location ~ \.php {   ，把$去掉，并在里面加上这两句

```
fastcgi_split_path_info ^(.+.php)(.*)$;     #增加
fastcgi_param PATH_INFO $fastcgi_path_info;    #增加
```

```
location ~ \.php { #去掉$
            root       html
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
            include        fastcgi_params;
            fastcgi_split_path_info ^(.+\.php)(.*)$;     #添加
            fastcgi_param PATH_INFO $fastcgi_path_info;    #添加
        }
```

## 传参

```
<?php
namespace app\index\controller;

class Index
{
    public function index()
    {
        return 'index';
    }public function hello($name = 'World')
    {
        return 'Hello,' . $name . '!';
    }
}
```

`http://tp5.com/index.php/index/index/hello?name=thinkphp`

`http://tp5.com/index.php/index/index/hello/name/thinkphp`

```
public function hello($name = 'World', $city = '')
{
return 'Hello,' . $name . '! You come from ' . $city . '.';
}
```

`http://tp5.com/index.php/index/index/hello/name/thinkphp/city/shanghai`

非严格顺序

`http://tp5.com/index.php/index/index/hello/city/shanghai/name/thinkphp`

`http://tp5.com/index.php/index/index/hello?city=shanghai&name=thinkphp`

强制严格顺序

`'url_param_type' => 1,`

##隐藏index.php

## 定义路由

我们在路由定义文件（ application/route.php ）里面添加一些路由规则，如下：

```
return [
// 添加路由规则 路由到 index控制器的hello操作方法
'hello/[:name]' => 'index/index/hello',
]

//使用 [] 把路由规则中的变量包起来，就表示该变量为可选
```

路由之前的URL访问地址为：
http://tp5.com/index/index/hello/name/thinkphp
定义路由后就只能访问下面的URL地址
http://tp5.com/hello/thinkph

**定义路由规则后，原来的URL地址将会失效，变成非法请求。**

除了路由配置文件中定义之外，还可以采用动态定义路由规则的方式定义，例如在路由配置文件（application/route.php ）的开头直接添加下面的方法：

```
use think\Route;
Route::rule('hello/[:name]', 'index/hello');
```

### 完整匹配

```
return [
// 路由参数name为可选
'hello/[:name]$' => 'index/hello',
];
```

http://tp5.com/hello // 正确匹配
http://tp5.com/hello/thinkphp // 正确匹配
http://tp5.com/hello/thinkphp/val/value // 不会匹配

### 闭包定义

```
return [
// 定义闭包
'hello/[:name]' => function ($name) {
return 'Hello,' . $name . '!';
},
];
```

### 设置URL分隔符

`'pathinfo_depr' => '-',`

`http://tp5.com/hello-thinkphp`

### 路由参数

```
return [
// 定义路由的请求类型和后缀
'hello/[:name]' => ['index/hello', ['method' => 'get', 'ext' => 'html']],
];
```

上面定义的路由规则限制了必须是 get 请求，而且后缀必须是 html 的，所以下面的访问地址：
http://tp5.com/hello // 无效
http://tp5.com/hello.html // 有效
http://tp5.com/hello/thinkphp // 无效
http://tp5.com/hello/thinkphp.html // 有效

##变量规则

```
<?php
namespace app\index\controller;

class Blog
{
    public function get($id)
    {
        return '查看id=' . $id . '的内容';
    }public function read($name)
    {
        return '查看name=' . $name . '的内容';
    }public function archive($year, $month)
    {
        return '查看' . $year . '/' . $month . '的归档内容';
    }
}
```

```
return [
'blog/:year/:month' => ['blog/archive', ['method' => 'get'], ['year' => '\d{4}', 'month' => '\d{2}']],
'blog/:id' => ['blog/get', ['method' => 'get'], ['id' => '\d+']],
'blog/:name' => ['blog/read', ['method' => 'get'], ['name' => '\w+']],
];
```

// 访问id为5的内容
http://tp5.com/blog/5
// 访问name为thinkphp的内容
http://tp5.com/blog/thinkphp
// 访问2015年5月的归档内容
http://tp5.com/blog/2015/05

## 路由分组

上面的三个路由规则由于都是 blog 打头，所以我们可以做如下的简化：

```php
return [
    '[blog]' => [
        ':year/:month' => ['blog/archive', ['method' => 'get'], ['year' => '\d{4}', 'month' => '\d{2}']],
        ':id' => ['blog/get', ['method' => 'get'], ['id' => '\d+']],
        ':name' => ['blog/read', ['method' => 'get'], ['name' => '\w+']],
    ],
];

```

## 复杂路由

http://tp5.com/blog/thinkphp
http://tp5.com/blog-2015-05

```
return [
    'blog/:id' => ['blog/get', ['method' => 'get'], ['id' => '\d+']],
    'blog/:name' => ['blog/read', ['method' => 'get'], ['name' => '\w+']],
    'blog-<year>-<month>' => ['blog/archive', ['method' => 'get'], ['year' => '\d{4}', 'month' => '\d{2}']],
];
```

对 blog-<year>-<month> 这样的非正常规范，我们需要使用 <变量名> 这样的变量定义方式，而不是
:变量名 方式。

在 `__pattern__` 中定义的变量规则我们称之为全局变量规则，在路由规则里面定义的变量规则我们称之为
局部变量规则，如果一个变量同时定义了全局规则和局部规则的话，当前的局部规则会覆盖全局规则的

## 生成URL地址

```
use think\Url;
...
public function read($name){
    return '查看name=' . $name . '的内容' . Url::build('blog/read', 'name=' . $name);
}
...
```

如果你配置了 url_html_suffix 参数的话，生成的URL地址会带上后缀。

`'url_html_suffix' => 'html',`

# 请求和响应

```
<?php
namespace app\index\controller;

use think\Controller;

class Index extends Controller
{
    public function hello($name = 'World')
    {
// 获取当前URL地址 不含域名
        echo 'url: ' . $this->request->url() . '<br/>';
        return 'Hello,' . $name . '！';
    }
}
```

或

```
<?php
namespace app\index\controller;
use think\Request;
class Index
{
public function hello(Request $request, $name = 'World')
{
// 获取当前URL地址 不含域名
echo 'url: ' . $request->url() . '<br/>';
return 'Hello,' . $name . '！';
}
}
```

##Request

###动态绑定属性

可以给Request请求对象绑定属性，方便全局调用，例如我们可以在公共控制器中绑定当前登录的用户模型到请求对象：

```
<?php
namespace app\index\controller;

use app\index\model\User;
use think\Controller;
use think\Request;
use think\Session;

class Base extends Controller
{
    public function _initialize()
    {
        $user = User::get(Session::get('user_id'));
        Request::instance()->bind('user', $user);
    }
}


<?php
namespace app\index\controller;

use app\index\controller\Base;
use think\Request;

class Index extends Base
{
    public function index(Request $request)
    {
        echo $request->user->id;
        echo $request->user->name;
    }
}

```

###使用助手函数（最好用）

```
<?php
namespace app\index\controller;

class Index
{
    public function hello($name = 'World')
    {
// 获取当前URL地址 不含域名
        echo 'url: ' . request()->url() . '<br/>';
        return 'Hello,' . $name . '！';
    }
}

```

###获取请求变量

```
<?php
namespace app\index\controller;

use think\Request;

class Index
{
    public function hello(Request $request)
    {
        echo 'GET参数：';
        dump($request->get());
        echo 'GET参数：name';
        dump($request->get('name'));
        echo 'POST参数：name';
        dump($request->post('name'));
        echo 'cookie参数：name';
        dump($request->cookie('name'));
        echo '上传文件信息：image';
        dump($request->file('image'));
        
        dump($request->param());
    }
}


<?php
namespace app\index\controller;

class Index
{
    public function hello()
    {
        echo 'GET参数：';
        dump(input('get.'));
        echo 'GET参数：name';
        dump(input('get.name'));
        echo 'POST参数：name';
        dump(input('post.name'));
        echo 'cookie参数：name';
        dump(input('cookie.name'));
        echo '上传文件信息：image';
        dump(input('file.image'));
    }
}

```
| 获取变量的方法包括 | 方法            |
| --------- | ------------- |
| param     | 获取请求变量        |
| get       | 获取$_GET变量     |
| post      | 获取$_POST变量    |
| put       | 获取PUT请求变量     |
| delete    | 获取DELETE请求变量  |
| patch     | 获取PATCH请求变量   |
| request   | 获取$_REQUEST变量 |
| route     | 获取路由（URL）变量   |
| session   | 获取$_SESSION变量 |
| cookie    | 获取$_COOKIE变量  |
| server    | 获取$_SERVER变量  |
| env       | 获取$_ENV变量     |
| file      | 获取上传文件信息      |
###获取请求参数

```php
<?php
namespace app\index\controller;

use think\Request;

class Index
{
    public function hello(Request $request)
    {
        echo '请求方法：' . $request->method() . '<br/>';
        echo '资源类型：' . $request->type() . '<br/>';
        echo '访问IP：' . $request->ip() . '<br/>';
        echo '是否AJax请求：' . var_export($request->isAjax(), true) . '<br/>';
        echo '请求参数：';
        dump($request->param());
        echo '请求参数：仅包含name';
        dump($request->only(['name']));
        echo '请求参数：排除name';
        dump($request->except(['name']));
    }
}

```

###获取URL信息

```php
<?php
namespace app\index\controller;

use think\Request;

class Index
{
    public function hello(Request $request, $name = 'World')
    {
// 获取当前域名
        echo 'domain: ' . $request->domain() . '<br/>';
// 获取当前入口文件
        echo 'file: ' . $request->baseFile() . '<br/>';
// 获取当前URL地址 不含域名
        echo 'url: ' . $request->url() . '<br/>';
// 获取包含域名的完整URL地址
        echo 'url with domain: ' . $request->url(true) . '<br/>';
// 获取当前URL地址 不含QUERY_STRING
        echo 'url without query: ' . $request->baseUrl() . '<br/>';
// 获取URL访问的ROOT地址
        echo 'root:' . $request->root() . '<br/>';
// 获取URL访问的ROOT地址
        echo 'root with domain: ' . $request->root(true) . '<br/>';
// 获取URL地址中的PATH_INFO信息
        echo 'pathinfo: ' . $request->pathinfo() . '<br/>';
// 获取URL地址中的PATH_INFO信息 不含后缀
        echo 'pathinfo: ' . $request->path() . '<br/>';
// 获取URL地址中的后缀信息
        echo 'ext: ' . $request->ext() . '<br/>';
        return 'Hello,' . $name . '！';
    }
}

```
| URL请求和信息方法可以总结如下 | 方法                        |
| ---------------- | ------------------------- |
| domain           | 获取当前的域名                   |
| url              | 获取当前的完整URL地址              |
| baseUrl          | 获取当前的URL地址，不含QUERY_STRING |
| baseFile         | 获取当前的SCRIPT_NAME          |
| root             | 获取当前URL的root地址            |
| pathinfo         | 获取当前URL的pathinfo地址        |
| path             | 获取当前URL的pathinfo地址，不含后缀   |
| ext              | 获取当前URL的后缀                |
| type             | 获取当前请求的资源类型               |
| scheme           | 获取当前请求的scheme             |
| query            | 获取当前URL地址的QUERY_STRING    |
| host             | 获取当前URL的host地址            |
| port             | 获取当前URL的port号             |
| protocol         | 获取当前请求的SERVER_PROTOCOL    |
| remotePort       | 获取当前请求的REMOTE_PORT        |
###获取当前模块/控制器/操作信息

```php
public function hello(Request $request, $name = 'World')
{
echo '模块：'.$request->module();
echo '<br/>控制器：'.$request->controller();
echo '<br/>操作：'.$request->action();
}
```

###获取路由和调度信息

## Response

###自动输出

大多数情况，我们不需要关注 Response 对象本身，只需要在控制器的操作方法中返回数据即可，系统会根据 default_return_type 和 default_ajax_return 配置决定响应输出的类型。

`'default_return_type' => 'json',`或者`'default_return_type' => 'xml',`

```php
<?php
namespace app\index\controller;

class Index
{
    public function hello()
    {
        $data = ['name' => 'thinkphp', 'status' => '1'];
        return $data;
    }
}
```

### 手动输出

```php
<?php
namespace app\index\controller;

class Index
{
    public function hello()
    {
        $data = ['name' => 'thinkphp', 'status' => '1'];
        return json($data);
    }
}


//状态码
<?php
namespace app\index\controller;

class Index
{
    public function hello()
    {
        $data = ['name' => 'thinkphp', 'status' => '1'];
        return json($data, 201);
    }
}

//或者发送更多的响应头信息
<?php
namespace app\index\controller;

class Index
{
    public function hello()
    {
        $data = ['name' => 'thinkphp', 'status' => '1'];
        return json($data, 201, ['Cache-control' => 'no-cache,must-revalidate']);
    }
}

//亦可以这样
class Index
{
    public function hello()
    {
        $data = ['name' => 'thinkphp', 'status' => '1'];
        return json($data)->code(201)->header(['Cache-control' => 'no-cache,must-revali
date', ]);
    }
}
```

| 默认支持的输出类型包括 | 输出类型     |
| ----------- | -------- |
| 渲染模板输出      | view     |
| JSON输出      | json     |
| JSONP输出     | jsonp    |
| XML输出       | xml      |
| 页面重定向       | redirect |

### 页面跳转

```php
use \traits\controller\Jump;
public function index($name='')
{
    if ('thinkphp' == $name) {
        $this->success('欢迎使用ThinkPHP5.0','hello');
    } else {
        $this->error('错误的name','guest');
    }
}
```

### 页面重定向

```php
namespace app\index\controller;

class Index
{
    use \traits\controller\Jump;
    public function index($name = '')
    {
        if ('thinkphp' == $name) {
            $this->redirect('http://thinkphp.cn');
        } else {
            $this->success('欢迎使用ThinkPHP', 'hello');
        }
    }public function hello()
    {
        return 'Hello,ThinkPHP!';
    }
}
```

# 数据库

pass

# 查询语言

pass

# 模型和关联

## 模型定义

```
CREATE TABLE IF NOT EXISTS `think_user`(
`id` int(8) unsigned NOT NULL AUTO_INCREMENT,
`nickname` varchar(50) NOT NULL COMMENT '昵称',
`email` varchar(255) NULL DEFAULT NULL COMMENT '邮箱',
`birthday` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '生日',
`status` tinyint(2) NOT NULL DEFAULT '0' COMMENT '状态',
`create_time` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '注册时间',
`update_time` int(11) UNSIGNED NOT NULL DEFAULT '0' COMMENT '更新时间',
PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;
```

database.php

```php
return [
    // 数据库类型
    'type' => 'mysql',
    // 服务器地址
    'hostname' => '127.0.0.1',
    // 数据库名
    'database' => 'demo',
    // 数据库用户名
    'username' => 'root',
    // 数据库密码
    'password' => '',
    // 数据库连接端口
    'hostport' => '',
    // 数据库连接参数
    'params' => [],
    // 数据库编码默认采用utf8
    'charset' => 'utf8',
    // 数据库表前缀
    'prefix' => 'think_',
    // 数据库调试模式
    'debug' => true,
];
```

route.php

```php
return [
    // 全局变量规则定义
    '__pattern__' => [
        'id' => '\d+',
    ],
    'user/index' => 'index/user/index',
    'user/create' => 'index/user/create',
    'user/add' => 'index/user/add',
    'user/add_list' => 'index/user/addList',
    'user/update/:id' => 'index/user/update',
    'user/delete/:id' => 'index/user/delete',
    'user/:id' => 'index/user/read',
];
```

定义模型

```php
namespace app\index\model;
use think\Model;
class User extends Model{
  
}

//自定义表名
class User extends Model{
  // 设置完整的数据表（ 包含前缀）
protected $table = 'think_user';
}

class User extends Model{
// 设置数据表（ 不含前缀）
protected $name = 'member';
}


//单独设置数据库
namespace app\index\model;
use think\Model;
class User extends Model
{
// 设置单独的数据库连接
    protected $connection = [
// 数据库类型
        'type' => 'mysql',
// 服务器地址
        'hostname' => '127.0.0.1',
// 数据库名
        'database' => 'test',
// 数据库用户名
        'username' => 'root',
// 数据库密码
        'password' => '',
// 数据库连接端口
        'hostport' => '',
// 数据库连接参数
        'params' => [],
// 数据库编码默认采用utf8
        'charset' => 'utf8',
// 数据库表前缀
        'prefix' => 'think_',
// 数据库调试模式
        'debug' => true,
    ];
}

```

模型会自动对应一个数据表，规范是：数据库前缀+当前的模型类名（不含命名空间）

## 基础操作

### 增

```php
<?php

namespace app\index\controller;

use app\index\model\User as UserModel;

class User
{
// 新增用户数据
    public function add()
    {
        $user = new UserModel;
        $user->nickname = '流年';
        $user->email = 'thinkphp@qq.com';
        $user->birthday = strtotime('1977-03-05');
        if ($user->save()) {
            return '用户[ ' . $user->nickname . ':' . $user->id . ' ]新增成功';
        } else {
            return $user->getError();
        }
    }
  
  //
      public function add()
    {
        $user['nickname'] = '看云';
        $user['email'] = 'kancloud@qq.com';
        $user['birthday'] = strtotime('2015-04-02');
        if ($result = UserModel::create($user)) {
            return '用户[ ' . $result->nickname . ':' . $result->id . ' ]新增成功';
        } else {
        }
        return '新增出错';
    }
}
```

默认情况下，实例化模型类后执行 save 操作都是执行的数据库 insert 操作，如果你需要实例化执行
save 执行数据库的 update 操作，请确保在save方法之前调用 isUpdate 方法：
`$user->isUpdate()->save();`

####批量

```php
// 批量新增用户数据
    public function addList()
    {
        $user = new UserModel;
        $list = [
            ['nickname' => '张三', 'email' => 'zhanghsan@qq.com', 'birthday' => strtotime('1988-01-15')],
            ['nickname' => '李四', 'email' => 'lisi@qq.com', 'birthday' => strtotime('1990-0 9-19')],
        ];
        if ($user->saveAll($list)) {
            return '用户批量新增成功';
        } else {
            return $user->getError();
        }
    }
```

### 查

####普通查询

```php
    // 读取用户数据
    public function read($id = '')
    {
        $user = UserModel::get($id);
        echo $user['nickname'] . '<br/>';
        echo $user->nickname . '<br/>';
        echo $user->email . '<br/>';
        echo date('Y/m/d', $user->birthday) . '<br/>';
    }
```

#### 构造器

```php
    // 根据nickname读取用户数据
    public function read()
    {
        $user = UserModel::where('nickname', '流年')->find();
        echo $user->nickname . '<br/>';
        echo $user->email . '<br/>';
        echo date('Y/m/d', $user->birthday) . '<br/>';
    }
```

#### 查询全部

```php
// 获取用户数据列表
    public function index()
    {
        $list = UserModel::all();
        foreach ($list as $user) {
            echo $user->nickname . '<br/>';
            echo $user->email . '<br/>';
            echo date('Y/m/d', $user->birthday) . '<br/>';
            echo '----------------------------------<br/>';
        }
    }
}

//条件
    public function index()
    {
        $list = UserModel::all(['status' => 1]);
        foreach ($list as $user) {
            echo $user->nickname . '<br/>';
            echo $user->email . '<br/>';
            echo date('Y/m/d', $user->birthday) . '<br/>';
            echo '----------------------------------<br/>';
        }
    }

//构造器
    public function index()
    {
        $list = UserModel::where('id','<',3)->select();
        foreach ($list as $user) {
            echo $user->nickname . '<br/>';
            echo $user->email . '<br/>';
            echo date('Y/m/d', $user->birthday) . '<br/>';
            echo '----------------------------------<br/>';
        }
    }
```

### 改

